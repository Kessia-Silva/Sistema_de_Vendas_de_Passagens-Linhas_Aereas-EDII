<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Consultar Cliente</title>

  <link rel="icon" href="static/img/IconAviao.ico" type="image/x-icon">
  <link rel="stylesheet" href="static/css/padrao.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
</head>

<body class="bg-light">

  <!-- Navbar -->
  <header class="Navbar d-flex justify-content-between align-items-center p-3">
    <div class="logo-container d-flex align-items-center">
      <h1 class="logo-text me-2">Linhas Aéreas EDII</h1>
      <img src="static/img/bandeiraDoBrasil.png" alt="Mapa Brasil" height="40">
    </div>

    <div class="d-flex align-items-center">
      <a href="/InicialAdm" title="Voltar">
        <i class="fas fa-right-from-bracket fa-lg" style="color: white;"></i>
      </a>
    </div>
  </header>

  <!-- Conteúdo -->
  <main class="container py-5">
    <div class="card shadow-sm p-4">
      <h2 class="text-center text-primary mb-4">Consultar Cliente</h2>

      <!-- FORM SELEÇÃO TIPO DE BUSCA -->
      <form method="POST">

        <label class="fw-semibold mb-2">Selecione o tipo de busca:</label>

        <select name="tipo_busca" id="tipo_busca" class="form-select mb-4" required>
          <option value="" selected disabled>Escolha uma opção</option>
          <option value="cpf">Buscar por CPF</option>
          <option value="nome">Buscar por Nome</option>
          <option value="inicial">Buscar pela Inicial do Nome</option>
        </select>

        <!-- CAMPO CPF -->
        <div id="campo_cpf" class="mb-3 d-none">
          <label class="form-label fw-semibold">Digite o CPF:</label>
          <input type="text" name="cpf_busca" class="form-control" placeholder="Ex: 12345678900">
        </div>

        <!-- CAMPO NOME -->
        <div id="campo_nome" class="mb-3 d-none">
          <label class="form-label fw-semibold">Digite o nome ou parte do nome:</label>
          <input type="text" name="nome_busca" class="form-control" placeholder="Ex: Ana">
        </div>

        <!-- CAMPO INICIAL -->
        <div id="campo_inicial" class="mb-3 d-none">
          <label class="form-label fw-semibold">Digite a inicial do nome:</label>
          <input type="text" maxlength="1" name="inicial" class="form-control" placeholder="Ex: A">
        </div>

        <button type="submit" class="btn btn-primary w-100">
          <i class="fas fa-search"></i> Buscar
        </button>
      </form>

      <!-- RESULTADOS -->
      {% if clientes %}
      <hr>
      <h4 class="text-center text-secondary mb-3">Resultados</h4>

      <ul class="list-group">
        {% for c in clientes %}
        <li class="list-group-item">
          <strong>Nome:</strong> {{ c.nome }} <br>
          <strong>CPF:</strong> {{ c.cpf }} <br>
          <strong>Reservas:</strong> {{ c.reservas|length }} <br>
          <strong>Milhas:</strong> {{ c.milhas }}
        </li>
        {% endfor %}
      </ul>
      {% endif %}

      {% if mensagem %}
      <div class="alert alert-info mt-4 text-center" id="mensagem">{{ mensagem }}</div>
      <script>
        setTimeout(() => document.getElementById("mensagem").style.display = "none", 3000);
      </script>
      {% endif %}

    </div>
  </main>

  <!-- SCRIPT PARA TROCAR OS CAMPOS -->
  <script>
    const select = document.getElementById("tipo_busca");

    const campoCPF = document.getElementById("campo_cpf");
    const campoNome = document.getElementById("campo_nome");
    const campoInicial = document.getElementById("campo_inicial");

    select.addEventListener("change", () => {
      campoCPF.classList.add("d-none");
      campoNome.classList.add("d-none");
      campoInicial.classList.add("d-none");

      if (select.value === "cpf") campoCPF.classList.remove("d-none");
      if (select.value === "nome") campoNome.classList.remove("d-none");
      if (select.value === "inicial") campoInicial.classList.remove("d-none");
    });
  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
